<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–Ü—Å—Ç–æ—Ä—ñ—è –ü–µ—Ä–µ–≤—ñ—Ä–æ–∫</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
.log-table {width:100%; border-collapse:collapse; margin-top:20px;}
.log-table th, .log-table td {border:1px solid #e0e0e0; padding:10px; text-align:left;}
.log-table th {background-color:#007bff; color:white; position:sticky; top:0;}
.log-table tr:nth-child(even) {background-color:#f9f9f9;}
.table-container {max-height:60vh; overflow-y:auto;}
/* –°—Ç–∏–ª—å –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ */
.message-box {color: #555; font-weight: 600; margin-top: 20px; padding: 10px; border-radius: 5px; background-color: #f0f0f0;}
</style>
</head>
<body>
<div class="container">
    <h1>–Ü—Å—Ç–æ—Ä—ñ—è –ü–µ—Ä–µ–≤—ñ—Ä–æ–∫ –ï–º–ø–∞—Ç—ñ—ó üìú</h1>
    <div class="navigation">
        <a href="{{ url_for('index', role=role) }}" class="nav-button">‚Üê –î–æ –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞</a>
        <a href="{{ url_for('graph') }}" class="nav-button">–ì—Ä–∞—Ñ—ñ–∫ –æ—Ü—ñ–Ω–æ–∫</a>
    </div>

    {% if role == 'psychologist' %}
    <form method="GET" action="{{ url_for('history') }}">
        <input type="hidden" name="role" value="psychologist">
        <label for="person_name">–§—ñ–ª—å—Ç—Ä –∑–∞ —ñ–º'—è–º:</label>
        <input type="text" id="person_name" name="person_name" value="{{ person_name_filter or '' }}">
        <button type="submit">–ü–æ–∫–∞–∑–∞—Ç–∏</button>
    </form>
    {% endif %}

    {% if message %}
    <p class="message-box">{{ message }}</p>
    {% endif %}

    {% if logs %}
    <div class="table-container">
        <table class="log-table">
            <thead>
                <tr>
                    <th>–î–∞—Ç–∞/–ß–∞—Å</th>
                    {% if role == 'psychologist' %}<th>–Ü–º'—è</th>{% endif %}
                    <th>–í–≤–µ–¥–µ–Ω–∏–π –¢–µ–∫—Å—Ç</th>
                    <th>–ö–ª–∞—Å –ï–º–ø–∞—Ç—ñ—ó</th>
                    <th>–í–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å (%)</th>
                </tr>
            </thead>
            <tbody>
                {% for log in logs %}
                <tr>
                    <td>{{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                    {% if role == 'psychologist' %}<td>{{ log.person_name or '–ê–Ω–æ–Ω—ñ–º' }}</td>{% endif %}
                    <td>{{ log.text_input[:100] }}{% if log.text_input|length > 100 %}...{% endif %}</td>
                    <td>{{ log.predicted_label }}</td>
                    <td>{{ "%.2f"|format(log.confidence) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    {% if not message %}
    <p class="message-box">–ù–∞—Ä–∞–∑—ñ —ñ—Å—Ç–æ—Ä—ñ—è –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –ø–æ—Ä–æ–∂–Ω—è.</p>
    {% endif %}
    {% endif %}
</div>
</body>
</html>